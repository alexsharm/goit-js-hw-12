{"version":3,"file":"commonHelpers.js","sources":["../src/main.js"],"sourcesContent":["import axios from 'axios';\nimport iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\nimport SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\nconst form = document.querySelector('.search-form');\nconst gallery = document.querySelector('.gallery');\nconst loader = document.querySelector('.loader');\nconst loadBtn = document.querySelector('.load-btn');\n\nlet totalPages;\nlet inputValue;\nlet page = 1;\nlet perPage = 40;\n\nconst galleryLightbox = new SimpleLightbox('.gallery a', {\n  captionsData: 'alt',\n});\n\nform.addEventListener('submit', handleSubmit);\nloadBtn.addEventListener('click', handleSubmit);\n\nfunction handleSubmit(evt) {\n  evt.preventDefault();\n  if (evt.target != loadBtn) {\n    loadBtn.classList.add('is-hidden');\n    inputValue = evt.target.elements.search.value;\n    gallery.innerHTML = '';\n    page = 1;\n    evt.target.reset();\n  }\n  loader.classList.remove('is-hidden');\n\n  async function getPhotos() {\n    const response = await axios.get(`https://pixabay.com/api/`, {\n      params: {\n        key: '41849912-0888eabd10c40a0c420151dd5',\n        q: inputValue,\n        image_type: 'photo',\n        orientation: 'horizontal',\n        safesearch: 'true',\n        page: page,\n        per_page: perPage,\n      },\n    });\n    return response.data;\n  }\n\n  getPhotos()\n    .then(data => {\n      console.log(data);\n      totalPages = Math.ceil(data.totalHits / perPage);\n      loader.classList.add('is-hidden');\n      if (data.hits.length === 0) {\n        const errorAlert = iziToast.error({\n          message:\n            'Sorry, there are no images matching <br> your search query. Please try again!',\n          position: 'topRight',\n          class: 'error-alert',\n        });\n      } else {\n        const htmlMarkup = data.hits\n          .map(\n            image =>\n              `\n        <li class=\"gallery-item\">\n         <a href=\"${image.largeImageURL}\">\n             <img class='gallery-image' src=\"${image.webformatURL}\" alt=\"${image.tags}\">\n         </a>\n        <div class=\"info-cont\">\n          <div class=\"info-item\">\n            <h4><b>Likes</b></h4>\n            <p>${image.likes}</p>\n          </div>\n          <div class=\"info-item\">\n            <h4><b>Views</b></h4>\n            <p>${image.views}</p>\n          </div>\n          <div class=\"info-item\">\n            <h4><b>Comments</b></h4>\n            <p>${image.comments}</p>\n          </div>\n          <div class=\"info-item\">\n            <h4><b>Downloads</b></h4>\n            <p>${image.downloads}</p>\n          </div>\n        </div>\n        </li>\n              `\n          )\n          .join('');\n        gallery.insertAdjacentHTML('beforeend', htmlMarkup);\n        loadBtn.classList.remove('is-hidden');\n        galleryLightbox.refresh();\n        if (evt.target === loadBtn) {\n          const galleryCardProperties = document\n            .querySelector('.gallery-item')\n            .getBoundingClientRect();\n          const galleryCardHeight = galleryCardProperties.height;\n          console.log(galleryCardHeight);\n          window.scrollBy({\n            top: 2 * galleryCardHeight,\n            behavior: 'smooth',\n          });\n        }\n        console.log(page);\n        console.log(totalPages);\n        if (page == totalPages) {\n          loadBtn.classList.add('is-hidden');\n          loader.classList.add('is-hidden');\n          return iziToast.error({\n            position: 'topRight',\n            message: `We're sorry, but you've reached the end of search results.`,\n          });\n        }\n        page += 1;\n      }\n    })\n    .catch(error => {\n      console.log(error);\n      iziToast.error({\n        position: 'topRight',\n        message: 'An error has occured',\n      });\n    });\n}\n\n// inputValue != evt.target.elements.search.value\n"],"names":["form","gallery","loader","loadBtn","totalPages","inputValue","page","perPage","galleryLightbox","SimpleLightbox","handleSubmit","evt","getPhotos","axios","data","iziToast","htmlMarkup","image","galleryCardHeight","error"],"mappings":"owBAKA,MAAMA,EAAO,SAAS,cAAc,cAAc,EAC5CC,EAAU,SAAS,cAAc,UAAU,EAC3CC,EAAS,SAAS,cAAc,SAAS,EACzCC,EAAU,SAAS,cAAc,WAAW,EAElD,IAAIC,EACAC,EACAC,EAAO,EACPC,EAAU,GAEd,MAAMC,EAAkB,IAAIC,EAAe,aAAc,CACvD,aAAc,KAChB,CAAC,EAEDT,EAAK,iBAAiB,SAAUU,CAAY,EAC5CP,EAAQ,iBAAiB,QAASO,CAAY,EAE9C,SAASA,EAAaC,EAAK,CACzBA,EAAI,eAAc,EACdA,EAAI,QAAUR,IAChBA,EAAQ,UAAU,IAAI,WAAW,EACjCE,EAAaM,EAAI,OAAO,SAAS,OAAO,MACxCV,EAAQ,UAAY,GACpBK,EAAO,EACPK,EAAI,OAAO,SAEbT,EAAO,UAAU,OAAO,WAAW,EAEnC,eAAeU,GAAY,CAYzB,OAXiB,MAAMC,EAAM,IAAI,2BAA4B,CAC3D,OAAQ,CACN,IAAK,qCACL,EAAGR,EACH,WAAY,QACZ,YAAa,aACb,WAAY,OACZ,KAAMC,EACN,SAAUC,CACX,CACP,CAAK,GACe,IACjB,CAEDK,EAAW,EACR,KAAKE,GAAQ,CAIZ,GAHA,QAAQ,IAAIA,CAAI,EAChBV,EAAa,KAAK,KAAKU,EAAK,UAAYP,CAAO,EAC/CL,EAAO,UAAU,IAAI,WAAW,EAC5BY,EAAK,KAAK,SAAW,EACJC,EAAS,MAAM,CAChC,QACE,gFACF,SAAU,WACV,MAAO,aACjB,CAAS,MACI,CACL,MAAMC,EAAaF,EAAK,KACrB,IACCG,GACE;AAAA;AAAA,oBAEMA,EAAM;AAAA,+CACqBA,EAAM,sBAAsBA,EAAM;AAAA;AAAA;AAAA;AAAA;AAAA,iBAKhEA,EAAM;AAAA;AAAA;AAAA;AAAA,iBAINA,EAAM;AAAA;AAAA;AAAA;AAAA,iBAINA,EAAM;AAAA;AAAA;AAAA;AAAA,iBAINA,EAAM;AAAA;AAAA;AAAA;AAAA,eAKZ,EACA,KAAK,EAAE,EAIV,GAHAhB,EAAQ,mBAAmB,YAAae,CAAU,EAClDb,EAAQ,UAAU,OAAO,WAAW,EACpCK,EAAgB,QAAO,EACnBG,EAAI,SAAWR,EAAS,CAI1B,MAAMe,EAHwB,SAC3B,cAAc,eAAe,EAC7B,wBAC6C,OAChD,QAAQ,IAAIA,CAAiB,EAC7B,OAAO,SAAS,CACd,IAAK,EAAIA,EACT,SAAU,QACtB,CAAW,CACF,CAGD,GAFA,QAAQ,IAAIZ,CAAI,EAChB,QAAQ,IAAIF,CAAU,EAClBE,GAAQF,EACV,OAAAD,EAAQ,UAAU,IAAI,WAAW,EACjCD,EAAO,UAAU,IAAI,WAAW,EACzBa,EAAS,MAAM,CACpB,SAAU,WACV,QAAS,4DACrB,CAAW,EAEHT,GAAQ,CACT,CACP,CAAK,EACA,MAAMa,GAAS,CACd,QAAQ,IAAIA,CAAK,EACjBJ,EAAS,MAAM,CACb,SAAU,WACV,QAAS,sBACjB,CAAO,CACP,CAAK,CACL"}