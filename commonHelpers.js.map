{"version":3,"file":"commonHelpers.js","sources":["../src/main.js"],"sourcesContent":["import axios from 'axios';\nimport iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\nimport SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\nconst form = document.querySelector('.search-form');\nconst gallery = document.querySelector('.gallery');\nconst loader = document.querySelector('.loader');\nconst loadBtn = document.querySelector('.load-btn');\n\nlet totalPages;\nlet inputValue;\nlet page = 1;\nlet perPage = 40;\n\nconst galleryLightbox = new SimpleLightbox('.gallery a', {\n  captionsData: 'alt',\n});\n\nform.addEventListener('submit', handleSubmit);\nloadBtn.addEventListener('click', handleClick);\n\nasync function getPhotos() {\n  try {\n    const httpResponse = await axios.get(`https://pixabay.com/api/`, {\n      params: {\n        key: '41849912-0888eabd10c40a0c420151dd5',\n        q: inputValue,\n        image_type: 'photo',\n        orientation: 'horizontal',\n        safesearch: 'true',\n        page: page,\n        per_page: perPage,\n      },\n    });\n    return httpResponse.data;\n  } catch (error) {\n    console.log(error);\n    iziToast.error({\n      position: 'topRight',\n      message: 'An error has occured',\n    });\n  }\n}\n\nfunction renderHtml(data) {\n  const htmlMarkup = data.hits\n    .map(\n      image =>\n        `\n        <li class=\"gallery-item\">\n         <a href=\"${image.largeImageURL}\">\n             <img class='gallery-image' src=\"${image.webformatURL}\" alt=\"${image.tags}\">\n         </a>\n        <div class=\"info-cont\">\n          <div class=\"info-item\">\n            <h4><b>Likes</b></h4>\n            <p>${image.likes}</p>\n          </div>\n          <div class=\"info-item\">\n            <h4><b>Views</b></h4>\n            <p>${image.views}</p>\n          </div>\n          <div class=\"info-item\">\n            <h4><b>Comments</b></h4>\n            <p>${image.comments}</p>\n          </div>\n          <div class=\"info-item\">\n            <h4><b>Downloads</b></h4>\n            <p>${image.downloads}</p>\n          </div>\n        </div>\n        </li>\n              `\n    )\n    .join('');\n  return htmlMarkup;\n}\n\nasync function handleSubmit(evt) {\n  evt.preventDefault();\n\n  loadBtn.classList.add('is-hidden');\n  inputValue = evt.target.elements.search.value;\n  gallery.innerHTML = '';\n  page = 1;\n  evt.target.reset();\n  loader.classList.remove('is-hidden');\n  try {\n    const photosData = await getPhotos();\n    totalPages = Math.ceil(photosData.totalHits / perPage);\n    loader.classList.add('is-hidden');\n    if (photosData.hits.length === 0) {\n      iziToast.error({\n        message:\n          'Sorry, there are no images matching <br> your search query. Please try again!',\n        position: 'topRight',\n        class: 'error-alert',\n      });\n    } else {\n      gallery.insertAdjacentHTML('beforeend', renderHtml(photosData));\n      loadBtn.classList.remove('is-hidden');\n      galleryLightbox.refresh();\n      if (page == totalPages) {\n        loadBtn.classList.add('is-hidden');\n        iziToast.error({\n          position: 'topRight',\n          message: `We're sorry, but you've reached the end of search results.`,\n        });\n      }\n      loader.classList.add('is-hidden');\n    }\n  } catch (error) {\n    console.log(error);\n    iziToast.error({\n      position: 'topRight',\n      message: 'An error has occured',\n    });\n  }\n}\n\nasync function handleClick() {\n  loader.classList.remove('is-hidden');\n  page += 1;\n  try {\n    const newPhotosData = await getPhotos();\n    gallery.insertAdjacentHTML('beforeend', renderHtml(newPhotosData));\n    galleryLightbox.refresh();\n    if (page == totalPages) {\n      loadBtn.classList.add('is-hidden');\n      iziToast.error({\n        position: 'topRight',\n        message: `We're sorry, but you've reached the end of search results.`,\n      });\n    }\n    loader.classList.add('is-hidden');\n    const galleryCardProperties = document\n      .querySelector('.gallery-item')\n      .getBoundingClientRect();\n    const galleryCardHeight = galleryCardProperties.height;\n    window.scrollBy({\n      top: 2 * galleryCardHeight,\n      behavior: 'smooth',\n    });\n  } catch (error) {\n    console.log(error);\n    iziToast.error({\n      position: 'topRight',\n      message: 'An error has occured',\n    });\n  }\n}\n"],"names":["form","gallery","loader","loadBtn","totalPages","inputValue","page","perPage","galleryLightbox","SimpleLightbox","handleSubmit","handleClick","getPhotos","axios","error","iziToast","renderHtml","data","image","evt","photosData","newPhotosData","galleryCardHeight"],"mappings":"+vBAKA,MAAMA,EAAO,SAAS,cAAc,cAAc,EAC5CC,EAAU,SAAS,cAAc,UAAU,EAC3CC,EAAS,SAAS,cAAc,SAAS,EACzCC,EAAU,SAAS,cAAc,WAAW,EAElD,IAAIC,EACAC,EACAC,EAAO,EACPC,EAAU,GAEd,MAAMC,EAAkB,IAAIC,EAAe,aAAc,CACvD,aAAc,KAChB,CAAC,EAEDT,EAAK,iBAAiB,SAAUU,CAAY,EAC5CP,EAAQ,iBAAiB,QAASQ,CAAW,EAE7C,eAAeC,GAAY,CACzB,GAAI,CAYF,OAXqB,MAAMC,EAAM,IAAI,2BAA4B,CAC/D,OAAQ,CACN,IAAK,qCACL,EAAGR,EACH,WAAY,QACZ,YAAa,aACb,WAAY,OACZ,KAAMC,EACN,SAAUC,CACX,CACP,CAAK,GACmB,IACrB,OAAQO,EAAP,CACA,QAAQ,IAAIA,CAAK,EACjBC,EAAS,MAAM,CACb,SAAU,WACV,QAAS,sBACf,CAAK,CACF,CACH,CAEA,SAASC,EAAWC,EAAM,CA+BxB,OA9BmBA,EAAK,KACrB,IACCC,GACE;AAAA;AAAA,oBAEYA,EAAM;AAAA,+CACqBA,EAAM,sBAAsBA,EAAM;AAAA;AAAA;AAAA;AAAA;AAAA,iBAKhEA,EAAM;AAAA;AAAA;AAAA;AAAA,iBAINA,EAAM;AAAA;AAAA;AAAA;AAAA,iBAINA,EAAM;AAAA;AAAA;AAAA;AAAA,iBAINA,EAAM;AAAA;AAAA;AAAA;AAAA,eAKlB,EACA,KAAK,EAAE,CAEZ,CAEA,eAAeR,EAAaS,EAAK,CAC/BA,EAAI,eAAc,EAElBhB,EAAQ,UAAU,IAAI,WAAW,EACjCE,EAAac,EAAI,OAAO,SAAS,OAAO,MACxClB,EAAQ,UAAY,GACpBK,EAAO,EACPa,EAAI,OAAO,QACXjB,EAAO,UAAU,OAAO,WAAW,EACnC,GAAI,CACF,MAAMkB,EAAa,MAAMR,IACzBR,EAAa,KAAK,KAAKgB,EAAW,UAAYb,CAAO,EACrDL,EAAO,UAAU,IAAI,WAAW,EAC5BkB,EAAW,KAAK,SAAW,EAC7BL,EAAS,MAAM,CACb,QACE,gFACF,SAAU,WACV,MAAO,aACf,CAAO,GAEDd,EAAQ,mBAAmB,YAAae,EAAWI,CAAU,CAAC,EAC9DjB,EAAQ,UAAU,OAAO,WAAW,EACpCK,EAAgB,QAAO,EACnBF,GAAQF,IACVD,EAAQ,UAAU,IAAI,WAAW,EACjCY,EAAS,MAAM,CACb,SAAU,WACV,QAAS,4DACnB,CAAS,GAEHb,EAAO,UAAU,IAAI,WAAW,EAEnC,OAAQY,EAAP,CACA,QAAQ,IAAIA,CAAK,EACjBC,EAAS,MAAM,CACb,SAAU,WACV,QAAS,sBACf,CAAK,CACF,CACH,CAEA,eAAeJ,GAAc,CAC3BT,EAAO,UAAU,OAAO,WAAW,EACnCI,GAAQ,EACR,GAAI,CACF,MAAMe,EAAgB,MAAMT,IAC5BX,EAAQ,mBAAmB,YAAae,EAAWK,CAAa,CAAC,EACjEb,EAAgB,QAAO,EACnBF,GAAQF,IACVD,EAAQ,UAAU,IAAI,WAAW,EACjCY,EAAS,MAAM,CACb,SAAU,WACV,QAAS,4DACjB,CAAO,GAEHb,EAAO,UAAU,IAAI,WAAW,EAIhC,MAAMoB,EAHwB,SAC3B,cAAc,eAAe,EAC7B,wBAC6C,OAChD,OAAO,SAAS,CACd,IAAK,EAAIA,EACT,SAAU,QAChB,CAAK,CACF,OAAQR,EAAP,CACA,QAAQ,IAAIA,CAAK,EACjBC,EAAS,MAAM,CACb,SAAU,WACV,QAAS,sBACf,CAAK,CACF,CACH"}